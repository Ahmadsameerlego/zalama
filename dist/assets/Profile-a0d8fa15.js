import{r as d,o as Z,l as M,b as r,c as i,e as t,t as s,q as B,h as S,s as O,g as k,v as _,f as b,F as T,i as j,d as A,w as L,T as ee,m as U,n as $}from"./index-4c615b4d.js";import{T as te}from"./Toast-7c860256.js";const oe={dir:"rtl",class:"bg-gradient-to-br from-orange-50 to-red-50 text-right min-h-screen"},se={class:"container mx-auto px-4 py-8"},ae={class:"text-4xl font-bold mb-8 text-center bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent"},re={class:"flex justify-center mb-8"},le={class:"bg-white/80 backdrop-blur-sm rounded-2xl p-2 shadow-xl"},ne={key:0,class:"max-w-2xl mx-auto"},ie={class:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl p-8 border border-white/20"},de={class:"text-2xl font-bold mb-6 flex items-center gap-3"},ue={class:"block mb-3 font-semibold text-gray-700"},ce={class:"block mb-3 font-semibold text-gray-700"},pe={class:"block mb-3 font-semibold text-gray-700"},ve={class:"block mb-3 font-semibold text-gray-700"},ge=["disabled"],fe={key:0,class:"flex items-center justify-center"},me={key:1},be={key:1,class:"max-w-2xl mx-auto"},ye={class:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl p-8 border border-white/20"},he={class:"text-2xl font-bold mb-6 flex items-center gap-3"},xe={class:"block mb-3 font-semibold text-gray-700"},we={class:"space-y-3 max-h-64 overflow-y-auto"},ke=["onClick"],_e={class:"font-semibold text-gray-800"},$e={class:"text-sm text-gray-500"},Ce={key:2,class:"max-w-4xl mx-auto"},Me={class:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl p-8 border border-white/20"},Be={class:"text-2xl font-bold mb-6 flex items-center gap-3"},Se={key:0,class:"space-y-6"},Te={class:"flex justify-between items-start mb-4"},Ae={class:"text-lg font-semibold"},Pe={class:"text-gray-500"},Ve={class:"text-left"},je={class:"space-y-2 mb-4"},Le={class:"border-t border-gray-200 pt-4 flex justify-between items-center"},ze={class:"font-semibold"},Ge=["onClick"],De={key:1,class:"text-center py-12"},Ne={class:"text-gray-500 text-lg"},Oe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4"},Ue={class:"relative bg-white rounded-3xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto"},Ee={class:"flex justify-between items-center mb-6"},Ie={class:"text-xl font-bold text-gray-800"},Fe={key:0,class:"mt-4"},He=["placeholder"],Je={key:1,class:"flex gap-4 mt-6"},Re={__name:"Profile",setup(qe){const f=d({visible:!1,message:"",type:"success"}),c=(e,o="success")=>{f.value={visible:!0,message:e,type:o},setTimeout(()=>f.value.visible=!1,3e3)},x=d(!1);d("");const P=d("");d([]),d({lat:null,lng:null,address:"",title:"home"});const v=d({lat:31.963158,lng:35.930359}),u=d(null),w=d(""),m=d("orders"),E=d(null),C=d(!1),z=(e=null)=>{E.value=e,e?(v.value={lat:e.lat,lng:e.lng},u.value={...v.value},w.value=e.address,C.value=!0):(navigator.geolocation&&navigator.geolocation.getCurrentPosition(o=>{v.value={lat:o.coords.latitude,lng:o.coords.longitude},u.value={...v.value}},()=>{v.value={lat:31.963158,lng:35.930359}}),u.value=null,w.value="",C.value=!1),x.value=!0,nextTick(()=>initSearchBox())},l=d({name:"",phone:"",email:"",address:"",password:""}),g=d(!1),V=d([]),n=JSON.parse(localStorage.getItem("user")||"{}"),I=async()=>{if(!(n!=null&&n.id)){f.error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø³ØªØ®Ø¯Ù…");return}try{g.value=!0;const e=await $.post("/api/show-user",{user_id:n.id});if(e.data.key===1){const o=e.data.data;l.value={name:o.first_name||"",phone:o.phone||"",email:o.email||"",address:o.address||""}}}catch(e){console.error("show-user error:",e)}finally{g.value=!1}},F=async()=>{if(!(n!=null&&n.id)){f.error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø³ØªØ®Ø¯Ù…");return}try{g.value=!0;const e=await $.post("/api/show-all-orders",{user_id:n.id});if(e.data.key===1){const o=e.data.data;V.value=o}else c(e.data.msg||"ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª","error")}catch(e){console.error("show-user error:",e),c("ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…","error")}finally{g.value=!1}},G=d([]),D=async()=>{if(!(n!=null&&n.id)){c("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø³ØªØ®Ø¯Ù…","error");return}try{g.value=!0;const e=await $.post("/api/all-addresses",{user_id:n.id});if(e.data.key===1){const o=e.data.data;G.value=o}else c(e.data.msg||"ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª","error")}catch(e){console.error("show-user error:",e),c("ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…","error")}finally{g.value=!1}},H=async()=>{if(!(n!=null&&n.id)){f.error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø³ØªØ®Ø¯Ù…");return}try{g.value=!0;const e=await $.post("/api/update-user",{user_id:n.id,first_name:l.value.name,phone:l.value.phone,email:l.value.email,address:l.value.address,password:l.value.password});e.data.key===1?(c(e.data.msg||"ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­","success"),localStorage.setItem("user",JSON.stringify({...n,name:l.value.name,phone:l.value.phone,email:l.value.email,address:l.value.address}))):c(e.data.msg||"ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª","error")}catch(e){console.error("update-user error:",e),c("ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…","error")}finally{g.value=!1}};function J(e){alert(`Ø³ÙŠØªÙ… ØªØªØ¨Ø¹ Ø§Ù„Ø·Ù„Ø¨ ${e}`)}function q(e){switch(e){case"new":return"bg-yellow-100 text-yellow-800";case"active":return"bg-orange-100 text-orange-800";case"finish":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}}function K(e){switch(e){case"new":return"ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±";case"active":return"Ù‚ÙŠØ¯ Ø§Ù„ØªØ­Ø¶ÙŠØ±";case"finish":return"ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„";default:return"ØºÙŠØ± Ù…Ø­Ø¯Ø¯"}}const Q=e=>{u.value={lat:e.latLng.lat(),lng:e.latLng.lng()},N()},R=e=>{u.value={lat:e.latLng.lat(),lng:e.latLng.lng()},N()},N=async()=>{if(!u.value)return;new google.maps.Geocoder().geocode({location:u.value},(o,p)=>{p==="OK"&&o[0]&&(w.value=o[0].formatted_address)})};Z(()=>{I(),F(),D(),navigator.geolocation&&navigator.geolocation.getCurrentPosition(p=>{v.value={lat:p.coords.latitude,lng:p.coords.longitude},u.value={...v.value},console.log(u,"fdfdfdfdfdfdfd")},p=>{console.warn("Geolocation error:",p)});const e=document.getElementById("searchBox");if(!e)return;const o=new google.maps.places.SearchBox(e);o.addListener("places_changed",()=>{const p=o.getPlaces();if(!p||!p.length)return;const y=p[0];y.geometry&&(v.value={lat:y.geometry.location.lat(),lng:y.geometry.location.lng()},u.value={...v.value},w.value=y.formatted_address)})});const W=async()=>{if(!u.value){c("Ø§Ø®ØªØ± Ù…ÙˆÙ‚Ø¹Ùƒ Ø£ÙˆÙ„Ø§Ù‹","error");return}try{const e=await $.post("/api/store-address",{user_id:n.id,title:P.value,address:w.value,lat:u.value.lat,lng:u.value.lng});e.data.key===1?(c("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ù†Ø¬Ø§Ø­","success"),x.value=!1,D()):c(e.data.msg||"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸","error")}catch(e){console.error(e),c("ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…","error")}};return(e,o)=>{const p=M("router-link"),y=M("GMapAutocomplete"),X=M("GMapMarker"),Y=M("GMapMap");return r(),i(T,null,[t("div",oe,[t("div",se,[t("h1",ae,s(e.$t("profile.title")),1),t("div",re,[t("div",le,[t("button",{onClick:o[0]||(o[0]=a=>m.value="profile"),class:B(["md:px-6 px-3 py-3 rounded-xl font-semibold transition-all",m.value==="profile"?"bg-primary text-white shadow-lg":"text-gray-600 hover:text-primary"])},s(e.$t("profile.tabs.personalData")),3),t("button",{onClick:o[1]||(o[1]=a=>m.value="addresses"),class:B(["md:px-6 md:px-3 px-1 py-3 rounded-xl font-semibold transition-all",m.value==="addresses"?"bg-primary text-white shadow-lg":"text-gray-600 hover:text-primary"])},s(e.$t("myAddresses")),3),t("button",{onClick:o[2]||(o[2]=a=>m.value="orders"),class:B(["md:px-6 md:px-3 px-1 py-3 rounded-xl font-semibold transition-all",m.value==="orders"?"bg-primary text-white shadow-lg":"text-gray-600 hover:text-primary"])},s(e.$t("profile.tabs.orders")),3)])]),m.value==="profile"?(r(),i("div",ne,[t("div",ie,[t("h2",de,[o[12]||(o[12]=t("svg",{class:"w-6 h-6 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),S(" "+s(e.$t("profile.personalData.title")),1)]),t("form",{onSubmit:O(H,["prevent"]),class:"space-y-6"},[t("div",null,[t("label",ue,s(e.$t("profile.personalData.name")),1),k(t("input",{"onUpdate:modelValue":o[3]||(o[3]=a=>l.value.name=a),type:"text",class:"w-full border-2 border-gray-200 rounded-xl px-4 py-4 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"},null,512),[[_,l.value.name]])]),t("div",null,[t("label",ce,s(e.$t("profile.personalData.phone")),1),k(t("input",{"onUpdate:modelValue":o[4]||(o[4]=a=>l.value.phone=a),type:"tel",class:"w-full border-2 border-gray-200 rounded-xl px-4 py-4 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all",style:{direction:"rtl"}},null,512),[[_,l.value.phone]])]),t("div",null,[t("label",pe,s(e.$t("profile.personalData.email")),1),k(t("input",{"onUpdate:modelValue":o[5]||(o[5]=a=>l.value.email=a),type:"email",class:"w-full border-2 border-gray-200 rounded-xl px-4 py-4 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"},null,512),[[_,l.value.email]])]),t("div",null,[t("label",ve,s(e.$t("password")),1),k(t("input",{"onUpdate:modelValue":o[6]||(o[6]=a=>l.value.password=a),type:"password",class:"w-full border-2 border-gray-200 rounded-xl px-4 py-4 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"},null,512),[[_,l.value.password]])]),t("button",{type:"submit",disabled:g.value,class:"w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-4 rounded-xl font-bold text-lg hover:from-orange-600 hover:to-red-600 transition-all shadow-lg"},[g.value?(r(),i("span",fe,o[13]||(o[13]=[t("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):(r(),i("span",me,s(e.$t("saveChanges")),1))],8,ge)],32)])])):b("",!0),m.value==="addresses"?(r(),i("div",be,[t("div",ye,[t("h2",he,[o[14]||(o[14]=t("svg",{class:"w-6 h-6 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),S(" "+s(e.$t("myAddresses")),1)]),t("form",{onSubmit:o[8]||(o[8]=O(()=>{},["prevent"])),class:"space-y-6"},[t("div",null,[t("label",xe,s(e.$t("myAddresses")),1),t("div",we,[(r(!0),i(T,null,j(G.value,a=>(r(),i("div",{key:a.id,onClick:h=>z(a),class:"p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-all hover:border-primary bg-white"},[t("div",_e,s(a.title),1),t("div",$e,s(a.address||a.lat+", "+a.lng),1)],8,ke))),128))])]),t("button",{onClick:o[7]||(o[7]=a=>z()),class:"w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-4 rounded-xl font-bold text-lg hover:from-orange-600 hover:to-red-600 transition-all shadow-lg"},s(e.$t("addNewAddress")),1)],32)])])):b("",!0),m.value==="orders"?(r(),i("div",Ce,[t("div",Me,[t("h2",Be,[o[15]||(o[15]=t("svg",{class:"w-6 h-6 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)),S(" "+s(e.$t("orders")),1)]),V.value.length?(r(),i("div",Se,[(r(!0),i(T,null,j(V.value,a=>(r(),i("div",{key:a.id,class:"border-2 border-gray-200 rounded-xl md:p-6 p-3 hover:border-primary transition-all"},[t("div",Te,[t("div",null,[t("h3",Ae,"Ø·Ù„Ø¨ #"+s(a.id),1),t("p",Pe,s(a.order_date_time),1)]),t("div",Ve,[t("span",{class:B(["px-3 py-1 rounded-full text-sm font-semibold",q(a.status)])},s(K(a.status)),3)])]),t("div",je,[(r(!0),i(T,null,j(a.items,h=>(r(),i("div",{key:h.id,class:"flex justify-between"},[t("span",null,s(h.service_title)+" Ã— "+s(h.count),1),t("span",null,s(h.total)+" "+s(e.$t("currency")),1)]))),128))]),t("div",Le,[t("div",null,[t("span",ze,s(e.$t("profile.tabs.orders"))+": "+s(a.sub_total)+" "+s(e.$t("currency")),1)]),t("button",{onClick:h=>J(a.id),class:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-dark transition-all"},s(e.$t("trackOrder")),9,Ge)])]))),128))])):(r(),i("div",De,[o[16]||(o[16]=t("div",{class:"text-6xl mb-4"},"ðŸ“¦",-1)),t("p",Ne,s(e.$t("noOrders")),1),A(p,{to:"/",class:"inline-block mt-4 bg-primary text-white px-6 py-3 rounded-xl font-semibold hover:bg-primary-dark transition-all"},{default:L(()=>[S(s(e.$t("continueShopping")),1)]),_:1})]))])])):b("",!0)])]),A(ee,{name:"fade-slide"},{default:L(()=>[x.value?(r(),i("div",Oe,[t("div",Ue,[t("div",Ee,[t("h3",Ie,s(e.$t("selectLocation")),1),t("button",{onClick:o[9]||(o[9]=a=>x.value=!1),class:"text-gray-400 hover:text-gray-700 bg-white rounded-full p-2 shadow-md"}," âœ• ")]),A(y,{placeholder:"This is a placeholder",onPlace_changed:e.setPlace,options:{bounds:{north:1.4,south:1.2,east:104,west:102},strictBounds:!0}},null,8,["onPlace_changed"]),A(Y,{center:v.value,zoom:13,style:{width:"100%",height:"300px"},onClick:R},{default:L(()=>[u.value?(r(),U(X,{key:0,position:u.value,draggable:!0,onDragend:Q},null,8,["position"])):b("",!0)]),_:1},8,["center"]),C.value?b("",!0):(r(),i("div",Fe,[k(t("input",{"onUpdate:modelValue":o[10]||(o[10]=a=>P.value=a),placeholder:e.$t("enterAddressPlaceholder"),class:"w-full border-2 border-gray-200 rounded-2xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-primary"},null,8,He),[[_,P.value]])])),C.value?b("",!0):(r(),i("div",Je,[t("button",{onClick:W,class:"flex-1 bg-gradient-to-r from-orange-500 to-red-500 text-white py-4 rounded-2xl font-semibold"},s(e.$t("confirmLocation")),1),t("button",{onClick:o[11]||(o[11]=a=>x.value=!1),class:"flex-1 bg-gray-200 text-gray-700 py-4 rounded-2xl font-semibold hover:bg-gray-300"},s(e.$t("cancel")),1)]))])])):b("",!0)]),_:1}),f.value.visible?(r(),U(te,{key:0,message:f.value.message,type:f.value.type,visible:f.value.visible},null,8,["message","type","visible"])):b("",!0)],64)}}};export{Re as default};
